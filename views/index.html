<!DOCTYPE html>
<html>
<head>
	<script src="/socket.io/socket.io.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
	<script src="/javascripts/handlers.js"></script>
	<script src="/javascripts/client.js"></script>
	<script src="/lib/messages.js"></script>
</head>
<body>
	<div style="float:left;width:100px;border-right:1px solid black;height:300px;padding:10px;overflow:scroll-y;">
		<b>USERS</b>
		<div id="users"></div>
	</div>
	<div style="float:left;width:300px;height:250px;overflow:scroll-y;padding:10px;">
		<div id="conversation"></div>
		<input id="data" style="width:200px;" />
		<input type="button" id="datasend" value="send" />
	</div>
		
	<script>
	
		var host = 'http://www.volcansoft.com';
		var port = 8080;
		
		var client = new client();
		client.registerHandler(Handlers.Connect, function(socket, request) {
			client.login('user' + Math.floor((Math.random()*1000)+1));
		});
		
		client.registerHandler(Handlers.LoginResponse, function(socket, message) {
			
			if (message.accepted) {
				
				console.log('joining room');
				
				// we were accepted so let's rock
				var plugin = client.createPlugin('DigGame', 'DiggingPlugin', 'DiggingPlugin');
				client.createRoom('', 'lobby', [plugin]);
			}
		});
		
		client.registerHandler(Handlers.JoinRoomEvent, function(socket, message) {
			console.log('join room!');
			client.sendPluginMessage('DiggingPlugin', 'lobby', {action:'init_me'});
		});
		
		client.registerHandler(Handlers.PluginMessageEvent, function(socket, message) {
			alert('woot! woot!');
		});	
		
		client.connect(host, port);
		
	</script>
</body>
</html>